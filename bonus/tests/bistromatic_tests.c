#include "criterion/criterion.h"
#include "bistromatic.h"

Test(eval_expr, additions)
{
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "123456+876543", 13), "999999");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "8+1", 3), "9");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "46237467824678264+156456", 24), "46237467824834720");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "546542+1564562834382462384632847", 32), "1564562834382462385179389");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "7328478234829365783265726384762386578236578236857638476782346782364782646198472837128948216478126471267415624762187462718469867429835789237892675892364782368492368577832567823562358326478238478236478236578+15645628343763846328463782647826478264732647236476298461984712834678324687246782649816489767486178463784567325467235647823647892365872358732648927856235623847209754823562987238057823567826598235678235423428935238562386572562765782365782345782365782365782382462384632847", 475), "15645628343763846328463782647826478264732647236476298461984712842006802922076148433082216152248565042021145562324874124605994674730655004931121764985183840325336226090978612000245286286296465665514024661321611130927168941055134360198350169344724108844020860698862869425");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "982472834782572436523647382957328567837409328948294809235789675325678236427348901849214981748723652738597823850923849028349175896195783205982385235926358275902389482093565766982374320840928401480923478923659823549081241809+8324789234782347825673625672548783254782057825672647298757864753786578346578637867824274287562357678235264782365782635762356728354264174891728946127846187254718256718", 389), "982472834782572436523647382957328567837409328948294809244114464560460584253022527521763765003505710564270471149681713782135754242774421073806659523488715954137654264459348402744731049195192576372652425051506010803799498527");
}

Test(eval_expr, substractions)
{
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "123456-876543", 13), "-753087");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "8-1", 3), "7");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "46237467824678264-156456", 24), "46237467824521808");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "546542-1564562834382462384632847", 32), "-1564562834382462384086305");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "7328478234829365783265726384762386578236578236857638476782346782364782646198472837128948216478126471267415624762187462718469867429835789237892675892364782368492368577832567823562358326478238478236478236578-15645628343763846328463782647826478264732647236476298461984712834678324687246782649816489767486178463784567325467235647823647892365872358732648927856235623847209754823562987238057823567826598235678235423428935238562386572562765782365782345782365782365782382462384632847", 475), "-15645628343763846328463782647826478264732647236476298461984712827349846452417416866550763382723791885547989088609597171041301110001089712534176090727287407369083283556147362475870360849356730805842446185536259346197604204070397204533214522220007455887543904225906396269");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "982472834782572436523647382957328567837409328948294809235789675325678236427348901849214981748723652738597823850923849028349175896195783205982385235926358275902389482093565766982374320840928401480923478923659823549081241809-8324789234782347825673625672548783254782057825672647298757864753786578346578637867824274287562357678235264782365782635762356728354264174891728946127846187254718256718", 389), "982472834782572436523647382957328567837409328948294809227464886090895888601675276176666198493941594912925176552165984274562597549617145338158110948364000597667124699727783131220017592486664226589194532795813636294362985091");
}

Test(eval_expr, multiplications)
{
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "7*3", 3), "21");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "76342784623874*7826347826478753467", 34), "597485186508391880417037968471158");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "46237467824678264*156456", 34), "7234129265977862472384");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "47628462384672836474726*74624628634782364764728", 48), "3554256317901911306281778438446085423908264528");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "-7328478234829365783265726384762386578236578236857638476782346782364782646198472837128948216478126471267415624762187462718469867429835789237892675892364782368492368577832567823562358326478238478236478236578*-15645628343763846328463782647826478264732647236476298461984712834678324687246782649816489767486178463784567325467235647823647892365872358732648927856235623847209754823562987238057823567826598235678235423428935238562386572562765782365782345782365782365782382462384632847", 477), "114658646787502766260277797626325566546981414344421065401051179414054490744674420803641352383547926532765965602494677929614306310291424624592999928125565299720321576393089580816696266098986368361827831670199493153375401744959380589522419745468119181059784312406216316955032751900863119926706451619485005873341676834057764965200786694175149731072358402840222559406355880688155912540752110103060766403657864363640305581788207709434571254788564027815799957342358258424535677566");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "982472834782572436523647382957328567837409328948294809235789675325678236427348901849214981748723652738597823850923849028349175896195783205982385235926358275902389482093565766982374320840928401480923478923659823549081241809*-8324789234782347825673625672548783254782057825672647298757864753786578346578637867824274287562357678235264782365782635762356728354264174891728946127846187254718256718", 390), "-8178879278464055236472756937765990005505966282332219421355886531994763268679386435340414544212482355685601944359121053906551958561933019213440726361348342331053720597473272487866483311573743705607360527551066847310191789068930511471208271310801466712348617801245321897447855398661097874938148846522909192484200821941873065205576350508919147007162685367856402743992691383089907143096722862");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "0000000000001*0000000001", 24), "1");
}

Test(eval_expr, final_boss)
{
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "----(7*3)*11+67*(87-9+4/6*4)%4", 30), "233");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "----++-6*12", 11), "-72");
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "-----(---+-----12-----+------(----4*----32))", 44), "116");

}

Test(eval_expr, modulo)
{
    cr_assert_str_eq(eval_expr("0123456789", "()+-*/%", "8%-3", 4), "2");
}